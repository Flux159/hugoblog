<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Create your own Windows Gaming PC on AWS&nbsp;|&nbsp;Suyog Sonwalkar</title><meta name=title content="Create your own Windows Gaming PC on AWS"><meta name=description content="Google Stadia recently came out and one of the interesting things about it is that it streams games from the cloud to your devices. I had previously built a gaming PC around 10 years ago with an Nvidia GTX 260 and an Intel Core i5-750 (eventually upgraded to Nvidia 750 Ti). I hadn’t used the PC in a while and my experiments with setting up VSCode on AWS got me thinking about setting up my own Gaming server on AWS too. Since this was an ideal use case for the cloud (an on demand machine that I use infrequently and will be consistently upgraded with the most recent GPUs), I wanted to see how I could setup a Windows PC on the AWS to play my Steam games."><meta name=keywords content="experiments,"><meta name=author content="Suyog Sonwalkar"><meta property="og:url" content="https://suyogs.com/p/experiments/windows-gaming-pc-on-aws/"><meta property="og:site_name" content="Suyog Sonwalkar"><meta property="og:title" content="Create your own Windows Gaming PC on AWS"><meta property="og:description" content="Google Stadia recently came out and one of the interesting things about it is that it streams games from the cloud to your devices. I had previously built a gaming PC around 10 years ago with an Nvidia GTX 260 and an Intel Core i5-750 (eventually upgraded to Nvidia 750 Ti). I hadn’t used the PC in a while and my experiments with setting up VSCode on AWS got me thinking about setting up my own Gaming server on AWS too. Since this was an ideal use case for the cloud (an on demand machine that I use infrequently and will be consistently upgraded with the most recent GPUs), I wanted to see how I could setup a Windows PC on the AWS to play my Steam games."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-12-30T00:00:00+00:00"><meta property="article:modified_time" content="2019-12-30T00:00:00+00:00"><meta property="article:tag" content="Experiments"><meta name=twitter:card content="summary"><meta name=twitter:title content="Create your own Windows Gaming PC on AWS"><meta name=twitter:description content="Google Stadia recently came out and one of the interesting things about it is that it streams games from the cloud to your devices. I had previously built a gaming PC around 10 years ago with an Nvidia GTX 260 and an Intel Core i5-750 (eventually upgraded to Nvidia 750 Ti). I hadn’t used the PC in a while and my experiments with setting up VSCode on AWS got me thinking about setting up my own Gaming server on AWS too. Since this was an ideal use case for the cloud (an on demand machine that I use infrequently and will be consistently upgraded with the most recent GPUs), I wanted to see how I could setup a Windows PC on the AWS to play my Steam games."><meta itemprop=name content="Create your own Windows Gaming PC on AWS"><meta itemprop=description content="Google Stadia recently came out and one of the interesting things about it is that it streams games from the cloud to your devices. I had previously built a gaming PC around 10 years ago with an Nvidia GTX 260 and an Intel Core i5-750 (eventually upgraded to Nvidia 750 Ti). I hadn’t used the PC in a while and my experiments with setting up VSCode on AWS got me thinking about setting up my own Gaming server on AWS too. Since this was an ideal use case for the cloud (an on demand machine that I use infrequently and will be consistently upgraded with the most recent GPUs), I wanted to see how I could setup a Windows PC on the AWS to play my Steam games."><meta itemprop=datePublished content="2019-12-30T00:00:00+00:00"><meta itemprop=dateModified content="2019-12-30T00:00:00+00:00"><meta itemprop=wordCount content="1295"><meta itemprop=keywords content="Experiments"><meta name=referrer content="no-referrer-when-downgrade"><link href=/bundle.min.css rel=stylesheet></head><body><header><nav><a href=/>Home</a>
<a href=/about/>About</a>
<a href=/index.xml><svg class="icon" viewBox="0 0 448 512"><path d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM0 416a64 64 0 11128 0A64 64 0 110 416zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg>
RSS</a></nav><h1>Create your own Windows Gaming PC on AWS</h1><p>by Suyog Sonwalkar</p></header><main><p><i><time style=color:var(--text-light) datetime=2019-12-30 pubdate>Dec 30, 2019</time></i></p><content><p><a href=https://en.wikipedia.org/wiki/Google_Stadia target=_blank>Google Stadia</a> recently came out and one of the interesting things about it is that it streams games from the cloud to your devices. I had previously built a gaming PC around 10 years ago with an Nvidia GTX 260 and an Intel Core i5-750 (eventually upgraded to Nvidia 750 Ti). I hadn’t used the PC in a while and my <a href=https://suyogs.com/experiments/000005-vscode-online target=_blank>experiments</a> with setting up VSCode on AWS got me thinking about setting up my own Gaming server on AWS too. Since this was an ideal use case for the cloud (an on demand machine that I use infrequently and will be consistently upgraded with the most recent GPUs), I wanted to see how I could setup a Windows PC on the AWS to play my Steam games.</p><h2 id=why-would-you-want-this>Why would you want this?</h2><p>I don’t usually use a PC for work or personal use (have a MacBook Pro for both) and I didn’t want to deal with purchasing expensive new GPUs or building a brand new PC. One of my overall visions for the future of computing is using thin(er) clients to connect to personalized workspaces in the cloud for all kinds of computing needs (Development work, Gaming, a different operating system when you need it). Amazon came out with <a href=https://aws.amazon.com/workspaces/ target=_blank>Amazon Workspaces</a> for this reason (and for enterprise management of data and apps in those workspaces), but their pricing for individuals is <a href=https://aws.amazon.com/workspaces/pricing/ target=_blank>insane</a> (as of this writing $735 per month or $22 + $1.75/hr for their minimal 8 vCPU, 15GB memory, 4GB GPU Memory machines). I thought that I could do better by using AWS directly with VMs. With this setup, I can get continuous hardware updates as AWS upgrades their machines, and I can stream my already purchased Steam games to my Mac, iPad, or iPhone.</p><h2 id=what-gpu-machines-are-available-on-aws-and-pricing>What GPU machines are available on AWS and Pricing</h2><p>AWS is always upgrading their machines, so as of January 1st, 2020 - their cheapest <strong>current</strong> instance with a GPU is a <a href=https://aws.amazon.com/ec2/instance-types/g4/ target=_blank>g4dn.xlarge</a> - a VM with 4 vCPUs, 16GB memory, and an hourly price of $0.526/hr on demand. Spot prices are currently only $0.19/hr (not including bandwidth or EBS Disk space).</p><p>These machines actually use <a href=https://www.nvidia.com/en-us/data-center/tesla-t4/ target=_blank>Nvidia T4</a> GPUs, which are current generation GPUs built primarily for Cloud Providers. They’re about 1/2 as powerful as the current top of the line 2080 Ti in <a href=https://www.anandtech.com/show/14663/the-nvidia-geforce-rtx-2080-super-review target=_blank>compute</a>, but have more graphics memory since they’re mainly used for professional scientific computing (specifically Machine Learning use cases).</p><h2 id=operating-system-and-specs>Operating System and Specs</h2><p>For this guide, we’ll be setting up a g4dn.xlarge with Windows Server 2019. After using Remote Desktop to authenticate to the server, we’ll download Nvidia drivers, setup some common applications we need and get Steam Link working.</p><h2 id=guide>Guide</h2><h2 id=get-an-aws-windows-vm>Get an AWS Windows VM</h2><ul><li>Login to your <a href="https://console.aws.amazon.com/ec2/home?region=us-east-1#Instances:sort=instanceId" target=_blank>AWS Console</a> and start a new Windows Instance (On Demand) with a g4dn.xlarge VM. Add a 128GB EBS Drive to the machine as well.</li></ul><p><img src=/images/windows_gaming_aws/launchinstance.png alt=launchinstance></p><p>Choose the Windows Server 2019 AMI with a g4dn vm.</p><p><img src=/images/windows_gaming_aws/windowsserver2019ami.png alt=windowsserver2019ami></p><p><img src=/images/windows_gaming_aws/g4dnvm.png alt=g4dnvm></p><p>Add a 128GB volume (or more) as your root volume. Feel free to resize to whatever size you need for your games. Note that since the vm is on AWS, steam downloads will generally be extremely fast (50MB/s +), so you could even get a smaller drive and just delete items as needed.</p><p><img src=/images/windows_gaming_aws/addvolume.png alt=addvolume></p><p>When adding a security group, make sure to make the following ports open along with TCP 22 for SSH:</p><p><img src=/images/windows_gaming_aws/ports1.png alt=ports1>
<img src=/images/windows_gaming_aws/ports2.png alt=ports2>
<img src=/images/windows_gaming_aws/ports3.png alt=ports3></p><p>When you launch the instance, you want to click on it in the AWS UI and use the &ldquo;Connect&rdquo; button to get Remote Desktop connection and password information.</p><p><img src=/images/windows_gaming_aws/connectbuttonaws.png alt=connect></p><p><img src=/images/windows_gaming_aws/downloadremotefile.png alt=downloadremotedesktop></p><p>Connect using your remote desktop client and get the password from the AWS connect modal.</p><p><img src=/images/windows_gaming_aws/remotedesktop.png alt=remotedesktop></p><p>Note that if you see this error message when retrieving your password, you usually just need to wait a few minutes while the VM is initializing.</p><p><img src=/images/windows_gaming_aws/windowspasswordnotavailableaws.png alt=passwordnotavailable></p><p>Once you&rsquo;ve connected via Remote desktop to your Windows Machine, you should see a virtual desktop</p><p><img src=/images/windows_gaming_aws/ec2windowsdesktop.png alt=ec2windowsdesktop></p><h2 id=disable-ie-restrictions-and-get-chrome>Disable IE Restrictions and get Chrome</h2><p>IE on Windows Server has some insane restrictions on website content and downloads. Open IE the first time and make sure to disable &ldquo;Internet Explorer Enhanced Security Configuration&rdquo; in Server Manager settings in order to download Chrome and set it up as your default browser.</p><p><img src=/images/windows_gaming_aws/ieawful.png alt=ieawful></p><p><img src=/images/windows_gaming_aws/servermanageriesettings0.png alt=servermanageriesettings0></p><p><img src=/images/windows_gaming_aws/servermanageriesettings.png alt=servermanageriesettings></p><p><img src=/images/windows_gaming_aws/makechromedefault.png alt=makechromedefault></p><h2 id=install-nvidia-graphics-drivers-grid-drivers>Install Nvidia Graphics Drivers, GRID drivers</h2><p>Following the <a href=https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/install-nvidia-driver-windows.html target=_blank>AWS Guide</a>, download the <a href=https://www.nvidia.com/Download/Find.aspx target=_blank>Nvidia graphics drivers</a> and <a href=https://s3.amazonaws.com/nvidia-gaming/GRID-436.30-vGaming-Windows-Guest-Drivers.zip target=_blank>GRID drivers</a> for your G4 machine. (The Nvidia Drivers are for T4 GPUs).</p><p><img src=/images/windows_gaming_aws/nvidiadriverst4.png alt=nvidiadriverst4></p><p><img src=/images/windows_gaming_aws/nvidiadriversinstalled.png alt=nvidiadriversinstalled></p><p>Make sure to also configure the GRID drivers appropriately according the the <a href=https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/install-nvidia-driver-windows.html target=_blank>AWS Guide</a></p><p><img src=/images/windows_gaming_aws/extractgrid.png alt=extractgrid></p><p><img src=/images/windows_gaming_aws/gridinstalled.png alt=gridinstalled></p><p><img src=/images/windows_gaming_aws/awsguidegridcomplete.png alt=awsguidegridcomplete></p><p><img src=/images/windows_gaming_aws/registryeditor.png alt=registryeditor></p><p><img src=/images/windows_gaming_aws/nvidianewdword.png alt=nvidianewdword></p><p><img src=/images/windows_gaming_aws/nvidiaeditdword.png alt=nvidiaeditdword></p><p><img src=/images/windows_gaming_aws/gridswcertpublic.png alt=gridswcertpublic></p><h2 id=disable-windows-basic-display-driver-and-install-windows-features>Disable Windows Basic Display Driver and install Windows Features</h2><p>Before restarting the VM, configure and install some windows settings and features. First, disable the windows basic display driver via device manager.</p><p><img src=/images/windows_gaming_aws/controlpanel.png alt=controlpanel></p><p><img src=/images/windows_gaming_aws/devicemanager.png alt=devicemanager></p><p><img src=/images/windows_gaming_aws/disablebasicdisplay.png alt=disablebasicdisplay></p><p>Then install some required Windows Features from Server Manager. Specifically after opening Server Manager, you want to use &ldquo;Local Server&rdquo;, and scroll all the way to the bottom to get to the &ldquo;Roles and Features&rdquo; section. In &ldquo;Tasks&rdquo;, you&rsquo;ll get a button to &ldquo;Add Roles and Features&rdquo;.</p><p>You want to add at least Media Foundation, QWAVE (Quality Windows Audio Video Experience), and .NET 3.5.</p><p><img src=/images/windows_gaming_aws/servermanager.png alt=servermanager></p><p><img src=/images/windows_gaming_aws/localserveraddfeature.png alt=localserveraddfeature></p><p><img src=/images/windows_gaming_aws/mediafoundationqwave.png alt=mediafoundationqwave></p><p>While you&rsquo;re installing these features, make sure to also <a href=https://support.microsoft.com/en-us/help/4028544/windows-10-turn-windows-defender-firewall-on-or-off target=_blank>disable Windows Firewall</a> so that you can accept incoming connections on the ports we&rsquo;ve opened for Steam.</p><p>Once you&rsquo;ve installed all the required drivers and Windows Features, restart the VM before proceeding to the next section.</p><h2 id=download-steam-hamachi-blender-razer-sound-71>Download Steam, Hamachi, Blender, Razer Sound 7.1</h2><p>Download and Install <a href=https://store.steampowered.com/about/ target=_blank>Steam</a>, <a href=https://www.vpn.net target=_blank>Hamachi</a>, <a href=https://www.blender.org/ target=_blank>Blender</a>, and <a href=https://www.razer.com/7.1-surround-sound target=_blank>Razer Sound 7.1</a>. Note that you only need to install Razer Sound, you don&rsquo;t need to log in (this is to provide audio drivers).</p><p>Login to the same Steam account on your VM and on your client. Also for Hamachi, make sure that your VM and Client are connected to the same VPN group.</p><p><img src=/images/windows_gaming_aws/steam.png alt=steam></p><p><img src=/images/windows_gaming_aws/hamachi.png alt=hamachi></p><p><img src=/images/windows_gaming_aws/blender.png alt=blender></p><h2 id=steam-settings-for-remote-play-on-host>Steam settings for Remote play on host</h2><p>When logged into Steam on the remote VM, go to Steam Settings -> Remote Play -> Advanced Host Options.</p><p><a href=https://steamcommunity.com/groups/homestream/discussions/0/1318835718943402340/ target=_blank>Disable</a> &ldquo;Dynamically adjust screen capture&rdquo; and &ldquo;Use NVFBC capture on NVIDIA GPU&rdquo; if you have issues with games crashing on startup.</p><p><img src=/images/windows_gaming_aws/steamoptions.png alt=steamoptions></p><h2 id=install-steam-games-you-want-to-play>Install Steam Games you want to play</h2><p>Install the steam games you want to play on the Remote VM. Once they&rsquo;re installed and you have Hamachi setup, you should be able to see on your client(s) the Steam &ldquo;Play&rdquo;/&ldquo;Install&rdquo; button become a &ldquo;Stream&rdquo; button. Before clicking &ldquo;Stream&rdquo;, you&rsquo;ll need to create a logout.bat file below and disconnect from Remote Desktop (RDP).</p><h2 id=create-logoutbat>Create logout.bat</h2><p>Create logout.bat that will log out of remote desktop, but keep Hamachi running (needed since Steam Link crashes while still connected to RDP).</p><p>The logout.bat batch script should have the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bat data-lang=bat><span class=line><span class=cl># This script locks the server, disconnects you from the servers RDP session
</span></span><span class=line><span class=cl># sending the session back to console so hamachi does not get disconnected
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>tscon 0 /dest:console
</span></span><span class=line><span class=cl>tscon 1 /dest:console
</span></span><span class=line><span class=cl>tscon 2 /dest:console
</span></span><span class=line><span class=cl>Rundll32.exe User32.dll,LockWorkStation</span></span></code></pre></div><p>Then connect via Steam Streaming when RDP isn&rsquo;t connected. Apparently Steam uses the same connection or something and errors out. Note that you need to ensure that you have a good connection to the server.</p><p>Now you can stream games with steam and profit!</p><h2 id=remote-workspace>Remote Workspace</h2><p>Optional:</p><ul><li>Since this is a full fledged remote workspace, you can download and use other GPU based tools (Blender, Maya, Photoshop) via RDP - although lag may be more noticeable through RDP and it might be better to do local development and use the remote server for rendering or when you need more compute.</li><li>This is also a fully useable Windows Environment if you need to test windows specific features or use Windows only tools.</li></ul><h2 id=references>References</h2><ul><li><a href=https://lg.io/2015/07/05/revised-and-much-faster-run-your-own-highend-cloud-gaming-service-on-ec2.html target=_blank>https://lg.io/2015/07/05/revised-and-much-faster-run-your-own-highend-cloud-gaming-service-on-ec2.html</a> - Primarily used this and adapted for Windows Server 2019 and newer Nvidia drivers</li><li><a href=https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/install-nvidia-driver-windows.html#nvidia-grid-g4 target=_blank>https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/install-nvidia-driver-windows.html#nvidia-grid-g4</a> - Main AWS Documentation Page for installing windows drivers</li><li><a href=https://steamcommunity.com/groups/homestream/discussions/0/1318835718943402340/ target=_blank>https://steamcommunity.com/groups/homestream/discussions/0/1318835718943402340/</a> - Fixing some steam link settings</li><li>Apparently Parsec was following a similar guide (just automated): <a href=https://github.com/jamesstringerparsec/Parsec-Cloud-Preparation-Tool/blob/master/PostInstall/PostInstall.ps1 target=_blank>https://github.com/jamesstringerparsec/Parsec-Cloud-Preparation-Tool/blob/master/PostInstall/PostInstall.ps1</a></li></ul></content><p><a href=/tags/experiments/>#Experiments</a>&nbsp;&nbsp;</p></main><footer><span>© 2019-2025 Suyog Sonwalkar</span></footer></body></html>